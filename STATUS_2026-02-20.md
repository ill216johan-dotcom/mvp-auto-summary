# MVP Auto-Summary ‚Äî –°—Ç–∞—Ç—É—Å –Ω–∞ 20.02.2026

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| PostgreSQL | ‚úÖ Running |
| SurrealDB | ‚úÖ Running |
| open-notebook | ‚úÖ Running (:8888 UI, :5055 API) |
| n8n | ‚úÖ Running (:5678) |
| transcribe_server.py | ‚úÖ Running (:9001) |
| **WF01 (—Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è)** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–æ Save Transcript |
| **WF02 (–¥–∞–π–¥–∂–µ—Å—Ç)** | ‚è≥ –ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª—Å—è —Å–µ–≥–æ–¥–Ω—è |
| **WF03 (–∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ summaries)** | ‚è≥ –ù–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª—Å—è |

## üîß –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è

1. **WF01**: –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π Whisper ‚Üí Async SpeechKit —á–µ—Ä–µ–∑ `transcribe_server.py:9001`
2. **WF01**: open-notebook URLs –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (`:5055`, `/api/notebooks`, `/api/sources/json`)
3. **WF01**: Retry loop –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞ (–¥–æ 10 –ø–æ–ø—ã—Ç–æ–∫ √ó 60 —Å–µ–∫)
4. **WF02**: `$env` –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ hardcoded –∑–Ω–∞—á–µ–Ω–∏—è
5. **WF02/03**: –î–æ–±–∞–≤–ª–µ–Ω–æ `thinking: {type: "disabled"}` –≤ GLM-4 –∑–∞–ø—Ä–æ—Å—ã
6. **docker-compose**: `OPEN_NOTEBOOK_URL=http://open-notebook:5055`

## üìç –ì–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å

**WF01 –ø—Ä–æ—à—ë–ª –¥–æ –∫–æ–Ω—Ü–∞!** –ü–æ—Å–ª–µ–¥–Ω–∏–π —Ç–µ—Å—Ç:
- –§–∞–π–ª: `1000023_—Ä–∞–∫—É—Ä—Å —Ç–µ—Ö–Ω–æ –ø–æ —Ä–∞—Å—Ö. –æ–∑–æ–Ω.webm`
- –¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç –ø–æ–ª—É—á–µ–Ω (26K+ —Å–∏–º–≤–æ–ª–æ–≤)
- Notebook `LEAD-1000023` –Ω–∞–π–¥–µ–Ω/—Å–æ–∑–¥–∞–Ω
- Source —Å–æ—Ö—Ä–∞–Ω—ë–Ω: `source:lxzwrpucoswhq2ov2mc2`

## üöÄ –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å

### 1. –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
cd /root/mvp-auto-summary
git pull
docker compose up -d --force-recreate n8n
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å transcribe_server.py
```bash
pgrep -a python3 | grep transcribe || \
  nohup python3 /root/mvp-auto-summary/scripts/transcribe_server.py >> /tmp/ts.log 2>&1 &
```

### 3. –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å workflows –≤ n8n
- UI: http://84.252.100.93:5678
- Workflows ‚Üí Add workflow ‚Üí ‚ãÆ ‚Üí Import from File
- –§–∞–π–ª—ã: `n8n-workflows/01-new-recording.json`, `02-daily-digest.json`, `03-individual-summary.json`

### 4. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å workflows
–í n8n UI –≤–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "Active" –¥–ª—è –∫–∞–∂–¥–æ–≥–æ workflow

### 5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å WF02 (–¥–∞–π–¥–∂–µ—Å—Ç)
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∞–π–¥–∂–µ—Å—Ç–∞
docker exec mvp-auto-summary-postgres-1 psql -U n8n -d n8n -c \
  "SELECT id, lead_id, status, summary_sent FROM processed_files WHERE status='completed' ORDER BY id DESC LIMIT 10;"

# –°–±—Ä–æ—Å–∏—Ç—å summary_sent –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
docker exec mvp-auto-summary-postgres-1 psql -U n8n -d n8n -c \
  "UPDATE processed_files SET summary_sent = false WHERE status='completed';"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å WF02 –≤—Ä—É—á–Ω—É—é –≤ n8n UI
```

## üîë –î–æ—Å—Ç—É–ø—ã

| –°–µ—Ä–≤–∏—Å | –ó–Ω–∞—á–µ–Ω–∏–µ |
|--------|----------|
| –°–µ—Ä–≤–µ—Ä | `root@84.252.100.93` / `xe1ZlW0Rpiyk` |
| n8n UI | `http://84.252.100.93:5678` / `rod@zevich.ru` / `Ill216johan511lol2` |
| open-notebook | `http://84.252.100.93:8888` |
| Telegram Bot | `@ffp_report_bot` |
| GLM-4 API | `https://open.bigmodel.cn/api/paas/v4/chat/completions` |
| GLM-4 Key | `fda5cc088ab04a1a92d5966b373e81a3.rfUescuUieAO78M6` |
| Yandex SpeechKit | –í `/root/mvp-auto-summary/scripts/transcribe_server.py` |

## üìÅ –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã

```
/root/mvp-auto-summary/
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ n8n-workflows/
‚îÇ   ‚îú‚îÄ‚îÄ 01-new-recording.json      ‚Üê WF01
‚îÇ   ‚îú‚îÄ‚îÄ 02-daily-digest.json       ‚Üê WF02
‚îÇ   ‚îî‚îÄ‚îÄ 03-individual-summary.json ‚Üê WF03
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ transcribe_server.py       ‚Üê HTTP —Å–µ—Ä–≤–µ—Ä :9001
‚îî‚îÄ‚îÄ docs/
    ‚îú‚îÄ‚îÄ SPECS.md
    ‚îî‚îÄ‚îÄ ERRORS.md                  ‚Üê –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π –æ—à–∏–±–æ–∫
```

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **–ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã (>100MB)** –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è ‚Äî –Ω—É–∂–Ω—ã –¥–ª—è —Ä—É—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
2. **–§–∞–π–ª—ã –±–µ–∑ LEAD-ID –≤ –Ω–∞—á–∞–ª–µ** –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è ‚Äî –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å: `101_—Ñ–∞–π–ª.webm`
3. **IF –Ω–æ–¥—ã** –≤ n8n 2.8.x –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç `notTrue` ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `equal`

---
*–°–æ–∑–¥–∞–Ω–æ: 20.02.2026 20:30 MSK*
